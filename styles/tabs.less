// Displays selectable tabs above the editor.
// Overrides: atom/tabs

@tab-height: 32px;
@icon-size: 32px;

.tab-bar {
  margin: 0;
  padding: 0;
  background-color: transparent;

  .tab {
    margin: 0;
    height: @tab-height;
    line-height: @tab-height;
    color: fadeout(@light-tone, 70%);
    font-size: 1rem;
    transition: color 0.3s, background-color 0.3s;

    &:hover {
      color: fadeout(@light-tone, 30%);
      background-color: @dark-tone;
    }

    &.active {
      color: @light-tone;
      background-color: @dark-tone-alt;
    }

    // ------------------------------------------------ "close" icon (the cross)

    .close-icon {
      top: 0;
      right: 0;
      opacity: 0;
      transition: opacity 0.3s;

      &::before {
        display: block;
        width: @icon-size;
        height: @icon-size;
        line-height: @icon-size;
        text-align: center;
      }
    }

    &:hover .close-icon {
      opacity: 1;

      &:hover {
        background-color: @accent;
      }
    }

    // -------------------------------------------- "modified" icon (the circle)

    &.modified:not(:hover) .close-icon {
      top: 15px;
      opacity: 1;
      border-color: @accent;
      background-color: @accent;
    }

    &.modified:hover .close-icon {
      color: @light-tone;
    }

    // -------------------------------------------------------- "dragging a tab"

    &.is-dragging {
      background: @dark-tone;

      & .close-icon {
        visibility: hidden;
      }
    }
  }
}

// --------------------------------------------------------- main editor tab bar

atom-workspace-axis.vertical > atom-pane-container.panes .tab-bar {
  position: relative;
  z-index: 2;

  // ----------------------------- active tab

  .tab.active {
    position: absolute;
    bottom: calc(-1 * @tab-height);
    left: 6px;
    max-width: none;
    height: calc(@tab-height - 6px);
    line-height: calc(@tab-height - 6px);
    background-color: fadeout(@dark-tone, 30%);
    border-radius: 5px;

    .close-icon {
      width: calc(@tab-height - 6px);
      height: calc(@tab-height - 6px);
      line-height: calc(@tab-height - 6px);
      border-radius: 0 5px 5px 0;

      &::before {
        width: calc(@tab-height - 6px);
        height: calc(@tab-height - 6px);
        line-height: calc(@tab-height - 6px);
      }
    }
  }
}

// ----------------------------------------------------------- left pane tab bar

.atom-dock-inner.left .tab-bar {
  margin: 12px;
  color: @dark-tone-alt-lighten;
  border: 1px solid @dark-tone-alt-lighten;

  .tab {
    &:hover {
      color: fadeout(@light-tone, 30%);
      background-color: @dark-tone-alt;
    }

    &.active {
      color: @light-tone;
      background-color: @dark-tone-alt-lighten;
    }
  }
}
